# SZU_gwt_official_account_spider
深大公文通-公众号-每日文章爬虫

基于kotlin的深大公文通公众号爬虫

## 使用
### 运行方式
下载release中的文件，安装Java环境，运行命令
```bat
java -jar gwt_spider.jar
```
即可。

### 功能
随时随地都可以爬公文，可以是账号登陆，也可以是easyconnect连接。
可以自己规定爬的公文的时间、标题关键词、种类、上限，然后用py脚本能做个排序。

## 关于登陆
老版本的学校系统登陆很容易，只要先访问获取cookies，然后把学号的密码连同获取的其他表单信息一起POST过去，再获取cookies就登陆成功了。

可是学校的登录系统，自从2020年疫情期间做了一次改版，你会发现POST过去的密码不是你的密码，而是一长串经过加密后的字符。研究了很久，发现学校使用了AES128加密，采用CBC的分组密码加密模式，使用POST表单中的defaultSalt进行UTF-8编码后的128位bit作为密钥，并随机生成长度为16的字母数字组合（编码后也就是128位bit）作为初始向量，同时在你的密码前面拼接长度为64的字母数字组合，然后进行加密，最后把加密结果进行base64编码转化为字符串，就是最后POST发出的密码。已经使用Python的crypto库检验过这种加密方式的正确性。

看上去很复杂是吗，没事，因为这些功能全部都集合在了encrypt.js中了，你可以在kotlin中使用js引擎直接调用。

## 关于公众号
公众号每天发布的文章就来自这个程序，当然由于公众号发文全程是自动化的，所以是拿这个程序进行修改的。

其中sorter.py脚本是**早期**公众号发文的排序脚本，辅助人工判断进行排序。现在公众号发文的过程早已全部自动化，不需要人的参与，现在公文的排序是交由神经网络进行的，具体细节可以参考[https://github.com/chimaoshu/SZU_gwt_predict_network](https://github.com/chimaoshu/SZU_gwt_predict_network)

## 关于小程序

小程序的爬虫比这个复杂多了，涉及到图片、附件、截图、公文HTML预处理、数据库等等内容，所以用的不是这个程序。

![小程序](https://img-blog.csdnimg.cn/20200712180936240.png)